name: orders
options:
  preview: false
  changeSlug: false
  changeStatus: false
  changeTemplate: false
  delete: false
  duplicate: false
  move: false
  sort: false
sections:
  stats:
    label: bnomei.kart.summary
    type: stats
    reports:
      - 
        label: bnomei.kart.latest-order
        value: '#{{ page.children.sortBy("paidDate", "desc").first.invoiceNumber }} ・ {{ page.children.sortBy("paidDate", "desc").first.customer.toUser.email }}'
        info: '{{ page.children.sortBy("paidDate", "desc").first.paidDate.toDate("Y-m-d H:i") }}'
        link: '{{ page.children.sortBy("paidDate", "desc").first.panel.url }}'
      - 
        label: bnomei.kart.revenue-30
        value: '{{ page.children.trend("paidDate", "sum").toFormattedCurrency }}'
        info: '{{ page.children.trendPercent("paidDate", "sum").toFormattedNumber(true) }}%'
        theme: '{{ page.children.trendTheme("paidDate", "sum") }}'
      - 
        label: bnomei.kart.orders-30
        value: '{{ page.children.interval("paidDate", "-30 days", "now").count }}'
        info: '{{ page.children.interval("paidDate", "-60 days", "-31 days").count }}'
  meta:
    type: fields
    fields:
      invnumber:
        label: bnomei.kart.latest-invoice-number
        type: number
        min: 1
        step: 1
        default: 1
        required: true
        translate: false
      line:
        type: line
  orders:
    label: bnomei.kart.orders
    type: pages
    search: true
    template: order
    sortBy: invnumber desc
    text: '[#{{ page.invoiceNumber }}] {{ page.customer.toUser.email }} ・ {{ page.formattedSubtotal }}'
    info: '{{ page.title }} ・ {{ page.paidDate.toDate("Y-m-d H:i") }}'
